(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("react/jsx-runtime"),require("react"),require("@tanstack/react-query")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","@tanstack/react-query"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o["interactive-elastic-react"]={},o["react/jsx-runtime"],o.React,o.ReactQuery))})(this,function(o,l,f,P){"use strict";/**
 * @license MIT <https://opensource.org/licenses/MIT>
 * @copyright Michael Hart 2022
 */const m=new TextEncoder,q={appstream2:"appstream",cloudhsmv2:"cloudhsm",email:"ses",marketplace:"aws-marketplace",mobile:"AWSMobileHubService",pinpoint:"mobiletargeting",queue:"sqs","git-codecommit":"codecommit","mturk-requester-sandbox":"mturk-requester","personalize-runtime":"personalize"},R=new Set(["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id","range","connection"]);class E{constructor({method:e,url:t,headers:n,body:c,accessKeyId:i,secretAccessKey:a,sessionToken:h,service:H,region:C,cache:B,datetime:N,signQuery:_,appendSessionToken:G,allHeaders:L,singleEncode:$}){if(t==null)throw new TypeError("url is a required option");if(i==null)throw new TypeError("accessKeyId is a required option");if(a==null)throw new TypeError("secretAccessKey is a required option");this.method=e||(c?"POST":"GET"),this.url=new URL(t),this.headers=new Headers(n||{}),this.body=c,this.accessKeyId=i,this.secretAccessKey=a,this.sessionToken=h;let T,x;(!H||!C)&&([T,x]=O(this.url,this.headers)),this.service=H||T||"",this.region=C||x||"us-east-1",this.cache=B||new Map,this.datetime=N||new Date().toISOString().replace(/[:-]|\.\d{3}/g,""),this.signQuery=_,this.appendSessionToken=G||this.service==="iotdevicegateway",this.headers.delete("Host"),this.service==="s3"&&!this.signQuery&&!this.headers.has("X-Amz-Content-Sha256")&&this.headers.set("X-Amz-Content-Sha256","UNSIGNED-PAYLOAD");const u=this.signQuery?this.url.searchParams:this.headers;if(u.set("X-Amz-Date",this.datetime),this.sessionToken&&!this.appendSessionToken&&u.set("X-Amz-Security-Token",this.sessionToken),this.signableHeaders=["host",...this.headers.keys()].filter(r=>L||!R.has(r)).sort(),this.signedHeaders=this.signableHeaders.join(";"),this.canonicalHeaders=this.signableHeaders.map(r=>r+":"+(r==="host"?this.url.host:(this.headers.get(r)||"").replace(/\s+/g," "))).join(`
`),this.credentialString=[this.datetime.slice(0,8),this.region,this.service,"aws4_request"].join("/"),this.signQuery&&(this.service==="s3"&&!u.has("X-Amz-Expires")&&u.set("X-Amz-Expires","86400"),u.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),u.set("X-Amz-Credential",this.accessKeyId+"/"+this.credentialString),u.set("X-Amz-SignedHeaders",this.signedHeaders)),this.service==="s3")try{this.encodedPath=decodeURIComponent(this.url.pathname.replace(/\+/g," "))}catch{this.encodedPath=this.url.pathname}else this.encodedPath=this.url.pathname.replace(/\/+/g,"/");$||(this.encodedPath=encodeURIComponent(this.encodedPath).replace(/%2F/g,"/")),this.encodedPath=w(this.encodedPath);const v=new Set;this.encodedSearch=[...this.url.searchParams].filter(([r])=>{if(!r)return!1;if(this.service==="s3"){if(v.has(r))return!1;v.add(r)}return!0}).map(r=>r.map(g=>w(encodeURIComponent(g)))).sort(([r,g],[k,j])=>r<k?-1:r>k?1:g<j?-1:g>j?1:0).map(r=>r.join("=")).join("&")}async sign(){return this.signQuery?(this.url.searchParams.set("X-Amz-Signature",await this.signature()),this.sessionToken&&this.appendSessionToken&&this.url.searchParams.set("X-Amz-Security-Token",this.sessionToken)):this.headers.set("Authorization",await this.authHeader()),{method:this.method,url:this.url,headers:this.headers,body:this.body}}async authHeader(){return["AWS4-HMAC-SHA256 Credential="+this.accessKeyId+"/"+this.credentialString,"SignedHeaders="+this.signedHeaders,"Signature="+await this.signature()].join(", ")}async signature(){const e=this.datetime.slice(0,8),t=[this.secretAccessKey,e,this.region,this.service].join();let n=this.cache.get(t);if(!n){const c=await p("AWS4"+this.secretAccessKey,e),i=await p(c,this.region),a=await p(i,this.service);n=await p(a,"aws4_request"),this.cache.set(t,n)}return y(await p(n,await this.stringToSign()))}async stringToSign(){return["AWS4-HMAC-SHA256",this.datetime,this.credentialString,y(await S(await this.canonicalString()))].join(`
`)}async canonicalString(){return[this.method.toUpperCase(),this.encodedPath,this.encodedSearch,this.canonicalHeaders+`
`,this.signedHeaders,await this.hexBodyHash()].join(`
`)}async hexBodyHash(){let e=this.headers.get("X-Amz-Content-Sha256")||(this.service==="s3"&&this.signQuery?"UNSIGNED-PAYLOAD":null);if(e==null){if(this.body&&typeof this.body!="string"&&!("byteLength"in this.body))throw new Error("body must be a string, ArrayBuffer or ArrayBufferView, unless you include the X-Amz-Content-Sha256 header");e=y(await S(this.body||""))}return e}}async function p(s,e){const t=await crypto.subtle.importKey("raw",typeof s=="string"?m.encode(s):s,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return crypto.subtle.sign("HMAC",t,m.encode(e))}async function S(s){return crypto.subtle.digest("SHA-256",typeof s=="string"?m.encode(s):s)}function y(s){return Array.prototype.map.call(new Uint8Array(s),e=>("0"+e.toString(16)).slice(-2)).join("")}function w(s){return s.replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())}function O(s,e){const{hostname:t,pathname:n}=s;if(t.endsWith(".r2.cloudflarestorage.com"))return["s3","auto"];if(t.endsWith(".backblazeb2.com")){const h=t.match(/^(?:[^.]+\.)?s3\.([^.]+)\.backblazeb2\.com$/);return h!=null?["s3",h[1]]:["",""]}const c=t.replace("dualstack.","").match(/([^.]+)\.(?:([^.]*)\.)?amazonaws\.com(?:\.cn)?$/);let[i,a]=(c||["",""]).slice(1,3);if(a==="us-gov")a="us-gov-west-1";else if(a==="s3"||a==="s3-accelerate")a="us-east-1",i="s3";else if(i==="iot")t.startsWith("iot.")?i="execute-api":t.startsWith("data.jobs.iot.")?i="iot-jobs-data":i=n==="/mqtt"?"iotdevicegateway":"iotdata";else if(i==="autoscaling"){const h=(e.get("X-Amz-Target")||"").split(".")[0];h==="AnyScaleFrontendService"?i="application-autoscaling":h==="AnyScaleScalingPlannerFrontendService"&&(i="autoscaling-plans")}else a==null&&i.startsWith("s3-")?(a=i.slice(3).replace(/^fips-|^external-1/,""),i="s3"):i.endsWith("-fips")?i=i.slice(0,-5):a&&/-\d$/.test(i)&&!/-\d$/.test(a)&&([i,a]=[a,i]);return[q[i]||i,a]}var X=Object.defineProperty,I=(s,e,t)=>e in s?X(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,d=(s,e,t)=>(I(s,typeof e!="symbol"?e+"":e,t),t);class K{constructor(e,t){d(this,"username"),d(this,"password"),this.username=e,this.password=t}async getAuthorizationHeader(){return{Authorization:"Basic "+btoa(this.username+":"+this.password)}}}class A{constructor(e){d(this,"credentials"),this.credentials=e}async getAuthorizationHeader(e){const t=new E({...this.credentials,headers:{"Content-Type":"application/x-ldjson"},url:e.url,body:e.body}),{headers:n}=await t.sign();return{authorization:n.get("authorization"),"x-amz-date":n.get("x-amz-date"),"x-amz-security-token":n.get("x-amz-security-token"),"Content-Type":"application/x-ndjson"}}}class W{constructor({endpoint:e,authorization:t}){switch(d(this,"endpoint"),d(this,"authorization"),this.endpoint=e,t.type){case"basic":const{username:n,password:c}=t;this.authorization=new K(n,c);break;case"awsSigned":const{credentials:i}=t;this.authorization=new A(i);break}}async makeRequest(e,t={},n,c="POST"){const i=this.endpoint+e;let a={};this.authorization instanceof A&&(a={url:i,body:n});const h=await this.authorization.getAuthorizationHeader(a);return await(await fetch(i,{method:c,headers:{...h,...t},body:n})).json()}}class U{constructor({apiOptions:e}){d(this,"api"),this.api=new W(e)}async get({path:e}){return this.api.makeRequest(e,{},null,"GET")}async post({path:e,body:t}){return this.api.makeRequest(e,{"Content-Type":"application/json"},t,"POST")}async search({index:e,body:t}){return this.post({path:`/${e}/_search`,body:t})}}class D extends U{async getClusterHealth(){return this.get({path:"/_cluster/health"})}}const b=f.createContext(null);function M({authorization:s,endpoint:e,children:t}){const n=new D({apiOptions:{authorization:s,endpoint:e}});return l.jsx(b.Provider,{value:n,children:t})}function z(){return f.useContext(b)}function Q(s=1e3){const e=z();return P.useQuery({queryKey:["clusterHealth"],queryFn:async()=>await e.getClusterHealth(),retryDelay:s})}o.ReadonlyOpensearch=M,o.useClient=z,o.useClusterHealth=Q,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
