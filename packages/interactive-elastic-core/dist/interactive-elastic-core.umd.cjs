(function(e,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("aws4fetch")):typeof define=="function"&&define.amd?define(["exports","aws4fetch"],s):(e=typeof globalThis<"u"?globalThis:e||self,s(e["interactive-elastic-core"]={},e.aws4fetch))})(this,function(e,s){"use strict";var w=Object.defineProperty;var z=(e,s,a)=>s in e?w(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;var o=(e,s,a)=>(z(e,typeof s!="symbol"?s+"":s,a),a);class a{constructor(t,n){o(this,"username");o(this,"password");this.username=t,this.password=n}async getAuthorizationHeader(){return{Authorization:"Basic "+btoa(this.username+":"+this.password)}}}class u{constructor(t){o(this,"credentials");this.credentials=t}async getAuthorizationHeader(t){const n=typeof this.credentials=="function"?await this.credentials():this.credentials,r=new s.AwsV4Signer({...n,headers:{"Content-Type":"application/x-ldjson"},url:t.url,body:t.body}),{headers:i}=await r.sign();return{authorization:i.get("authorization"),"x-amz-date":i.get("x-amz-date"),"x-amz-security-token":i.get("x-amz-security-token"),"Content-Type":"application/x-ndjson"}}}class l{constructor({endpoint:t,authorization:n}){o(this,"endpoint");o(this,"authorization");switch(this.endpoint=t,n.type){case"basic":const{username:r,password:i}=n;this.authorization=new a(r,i);break;case"awsSigned":const{credentials:h}=n;this.authorization=new u(h);break}}async makeRequest(t,n={},r,i="POST"){const h=this.endpoint+t;let d={};this.authorization instanceof u&&(d={url:h,body:r});const f=await this.authorization.getAuthorizationHeader(d);return await(await fetch(h,{method:i,headers:{...f,...n},body:r})).json()}}class p{constructor({apiOptions:t}){o(this,"api");this.api=new l(t)}async get({path:t}){return this.api.makeRequest(t,{},null,"GET")}async post({path:t,body:n}){return this.api.makeRequest(t,{"Content-Type":"application/json"},n,"POST")}async search({index:t,body:n}){return this.post({path:`/${t}/_search`,body:n})}}class y extends p{async getClusterHealth(){return this.get({path:"/_cluster/health"})}}e.ReadOnlyClient=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
