(function(e,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("aws4fetch")):typeof define=="function"&&define.amd?define(["exports","aws4fetch"],s):(e=typeof globalThis<"u"?globalThis:e||self,s(e["interactive-elastic-core"]={},e.aws4fetch))})(this,function(e,s){"use strict";var f=Object.defineProperty;var z=(e,s,i)=>s in e?f(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i;var o=(e,s,i)=>(z(e,typeof s!="symbol"?s+"":s,i),i);class i{constructor(t,n){o(this,"username");o(this,"password");this.username=t,this.password=n}async getAuthorizationHeader(){return{Authorization:"Basic "+btoa(this.username+":"+this.password)}}}class u{constructor(t){o(this,"credentials");this.credentials=t}async getAuthorizationHeader(t){const n=new s.AwsV4Signer({...this.credentials,headers:{"Content-Type":"application/x-ldjson"},url:t.url,body:t.body}),{headers:a}=await n.sign();return{authorization:a.get("authorization"),"x-amz-date":a.get("x-amz-date"),"x-amz-security-token":a.get("x-amz-security-token"),"X-Amz-Content-Sha256":a.get("X-Amz-Content-Sha256"),"Content-Type":"application/x-ndjson"}}}class p{constructor({endpoint:t,authorization:n}){o(this,"endpoint");o(this,"authorization");switch(this.endpoint=t,n.type){case"basic":const{username:a,password:h}=n;this.authorization=new i(a,h);break;case"awsSigned":const{credentials:c}=n;this.authorization=new u(c);break}}async makeRequest(t,n={},a,h="POST"){const c=this.endpoint+t;let d={};this.authorization instanceof u&&(d={url:c,body:a});const w=await this.authorization.getAuthorizationHeader(d);return await(await fetch(c,{method:h,headers:{...w,...n},body:a})).json()}}class l{constructor({apiOptions:t}){o(this,"api");this.api=new p(t)}async get({path:t}){return this.api.makeRequest(t,{},null,"GET")}async post({path:t,body:n}){return this.api.makeRequest(t,{"Content-Type":"application/json"},n,"POST")}async search({index:t,body:n}){return this.post({path:`/${t}/_search`,body:n})}}class y extends l{async getClusterHealth(){return this.get({path:"/_cluster/health"})}}e.ReadOnlyClient=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
